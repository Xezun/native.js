"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},NativeMode=function(){var a=Object.freeze({url:"url",json:"json",object:"object",javascript:"javascript"});return _NativeDefineProperty(window,"NativeMode",{get:function get(){return a}}),_NativeDefineProperty(window,"NativeType",{get:function get(){return _NativeLog("NativeType was deprecated, please use NativeMode instead.",1),a}}),a}(),NativeLogStyle=function(){var a=Object.freeze({default:0,warning:1,error:2});return _NativeDefineProperty(window,"NativeLogStyle",{get:function get(){return a}}),a}(),NativeMethod=function(){var a=Object.freeze({ready:"ready",alert:"alert",dataService:Object.freeze({cachedResourceForURL:"dataService/cachedResourceForURL",numberOfRowsInList:"dataService/numberOfRowsInList",dataForRowAtIndex:"dataService/dataForRowAtIndex"}),eventService:Object.freeze({track:"eventService/track",documentElementWasClicked:"eventService/documentElementWasClicked",documentElementDidSelect:"eventService/documentElementDidSelect"}),login:"login",navigation:Object.freeze({push:"navigation/push",pop:"navigation/pop",popTo:"navigation/popTo",bar:Object.freeze({setHidden:"navigation/bar/setHidden",setTitle:"navigation/bar/setTitle",setTitleColor:"navigation/bar/setTitleColor",setBackgroundColor:"navigation/bar/setBackgroundColor"})}),networking:Object.freeze({http:"networking/http"}),open:"open",present:"present",dismiss:"dismiss",setCurrentTheme:"setCurrentTheme"});return _NativeDefineProperty(window,"NativeMethod",{get:function get(){return a}}),a}(),NativeCookieKey=function(){var a=Object.freeze({currentTheme:"com.mlibai.native.cookie.currentTheme",currentUser:"com.mlibai.native.cookie.currentUser"});return _NativeDefineProperty(window,"NativeCookieKey",{get:function get(){return a}}),a}(),NativeCachedResourceType=Object.freeze({image:"image"}),Native=function(){function a(d){if(!d)return"";switch("undefined"==typeof d?"undefined":_typeof(d)){case"string":return encodeURIComponent(d);case"undefined":return"";default:return encodeURIComponent(JSON.stringify(d));}}function b(d){if(!d)return"";if(Array.isArray(d)){for(var e=[],f=0;f<d.length;f++)e.push(a(d[f]));return e.join("&")}switch("undefined"==typeof d?"undefined":_typeof(d)){case"string":return encodeURIComponent(d);case"object":var g="";for(var h in d)d.hasOwnProperty(h)&&(0<g.length?g+="&"+encodeURIComponent(h):g=encodeURIComponent(h),!!d[h])&&(g+="="+a(d[h]));return g;case"undefined":return"";default:return encodeURIComponent(JSON.stringify(d));}}var c=new _Cookie;return _NativeDefineProperty(window,"Native",{get:function get(){return _Native}}),_NativeDefineProperties(_Native,{version:{get:function get(){return"1.0.0"}},log:{get:function get(){return _NativeLog}},cookie:{get:function get(){return c}},parseURLQueryValue:{get:function get(){return a}},parseURLQuery:{get:function get(){return b}}}),_Native}(),native=function(){var a=new Native;return _NativeDefineProperty(window,"native",{get:function get(){return a}}),a}();function _NativeLog(a,b){"number"!=typeof b||0===b?console.log("%c[Native]%c %s","color: #0b78d7; font-weight: bold;","color: #333333",a):1===b?console.log("%c[Native]%c %s","color: #0b78d7; font-weight: bold;","color: #fe7e3c",a):2==b&&console.log("%c[Native]%c %s","color: #0b78d7; font-weight: bold;","color: #d8463c",a)}function _NativeDefineProperty(a,b,c){return"undefined"==typeof a?_NativeLog("Define property error: Can not define properties for an undefined value.",2):"string"!=typeof b||0===b.length?_NativeLog("Define property error: The name for "+a.constructor.name+"'s property must be a nonempty string.",2):a.hasOwnProperty(b)?_NativeLog("Define property warning: The property "+b+" to be defined for "+a.constructor.name+" is already exist.",1):void Object.defineProperty(a,b,c)}function _NativeDefineProperties(a,b){if("undefined"==typeof a)return _NativeLog("Define properties error: Can not define properties for an undefined value.",2);if("object"!==("undefined"==typeof b?"undefined":_typeof(b)))return _NativeLog("Define properties error: The property list for "+a.constructor.name+" at second parameter must be an Object.",2);for(var c in b)b.hasOwnProperty(c)&&_NativeDefineProperty(a,c,b[c])}function _Native(){function a(h){return g.isReady?(window.setTimeout(h),this):(e.push(h),this)}function b(h){return"function"==typeof h?(g.isReady?_NativeDefineProperties(this,h.apply(this,[c])):d.push(h),this):this}var c=null,d=[],e=[],f=this,g=new _CoreNative(function(h){for(c=h;0<d.length;){var j=d.shift();_NativeDefineProperties(f,j.apply(f,[c]))}for(;0<e.length;)e.shift().apply(window)});_NativeDefineProperties(this,{core:{get:function get(){return g}},ready:{get:function get(){return a}},extend:{get:function get(){return b}}})}function _CoreNative(a){function b(q,r){switch("undefined"==typeof q?"undefined":_typeof(q)){case"function":var s="NT"+j++;return k[s]=q,s;case"string":if(!k.hasOwnProperty(q))return;var t=k[q];return(r||"undefined"==typeof r)&&delete k[q],t;default:return Native.log("Only callback function or callback is allowed",NativeLogStyle.error),void 0;}}function c(){return l===NativeMode.url?d.apply(this,arguments):l===NativeMode.json?e.apply(this,arguments):l===NativeMode.object?f.apply(this,arguments):l===NativeMode.javascript?g.apply(this,arguments):Native.log("\u8C03\u7528\u539F\u751F App \u65B9\u6CD5\u5931\u8D25\uFF0C\u65E0\u6CD5\u786E\u5B9A\u539F\u751FApp\u53EF\u63A5\u53D7\u7684\u6570\u636E\u7C7B\u578B\u3002",NativeLogStyle.error)}function d(q){for(var t,r=[],s=1;s<arguments.length;s+=1)t=arguments[s],"function"==typeof t?r.push(b(t)):r.push(t);var u=n+"://"+q+"?parameters="+Native.parseURLQueryValue(r),v=document.createElement("iframe");v.style.display="none",v.setAttribute("src",u),document.body.appendChild(v),window.setTimeout(function(){document.body.removeChild(v)},2e3),"function"==typeof m&&m(u)}function e(q){for(var t,r=[q],s=1;s<arguments.length;s+=1)switch(t=arguments[s],"undefined"==typeof t?"undefined":_typeof(t)){case"number":case"string":case"boolean":r.push(t);break;case"function":r.push(b(t));break;default:r.push(JSON.stringify(t));}f.apply(this,r)}function f(q){for(var r=[],s=1;s<arguments.length;s+=1)r.push(arguments[s]);window.setTimeout(function(){for(var t=q.split("/"),u=m,v=0;v<t.length;v++)u=u[t[v]];u.apply(window,r)})}function g(q){for(var r=[],s=1;s<arguments.length;s++)"function"==typeof arguments[s]?r.push(b(arguments[s])):r.push(arguments[s]);window.setTimeout(function(){m.apply(window,[q,r])})}function h(q,r){function s(){p=c(window.NativeMethod.ready,function(u){o=!0,p=null,a(u)})}if(m=q,l=r,o)return this;if(!p||b(p,!0),"complete"===document.readyState)window.setTimeout(function(){s()});else{var t=function(){document.removeEventListener("DOMContentLoaded",t),window.removeEventListener("load",t),s()};document.addEventListener("DOMContentLoaded",t),window.addEventListener("load",t)}return this}var j=1e7,k={},l=NativeMode.url,m=null,n="native",o=!1,p=null;_NativeDefineProperties(this,{callback:{get:function get(){return b}},perform:{get:function get(){return c}},scheme:{get:function get(){return n},set:function set(q){n=q}},isReady:{get:function get(){return o}},register:{get:function get(){return h}},delegate:{get:function get(){return m},set:function set(q){m=q}},mode:{get:function get(){return l},set:function set(q){l=q}}})}function _Cookie(){function a(){if(!d){d={},window.setTimeout(function(){d=null});var e=document.cookie;if(e)for(var g,f=e.split("; ");0<f.length;)if(g=f.pop().split("="),Array.isArray(g)&&0!==g.length){var h=decodeURIComponent(g[0]);d[h]=1<g.length?decodeURIComponent(g[1]):null}}}function b(e,f){if("undefined"==typeof f)return a(),d.hasOwnProperty(e)?d[e]:void 0;var g=new Date;return f?(g.setTime(g.getTime()+2592000000),"string"!=typeof f&&(f=JSON.stringify(f)),document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(f)+"; expires="+g.toUTCString()):(g.setTime(g.getTime()-1),document.cookie=encodeURIComponent(e)+"; expires="+g.toUTCString()),!d||(d[e]=f),this}function c(){return d=null,this}var d=null;_NativeDefineProperties(this,{value:{get:function get(){return b}},synchronize:{get:function get(){return c}}})}native.extend(function(){function a(b){if(!b)return Native.log("Method `login` called without a callback is not allowed.",NativeLogStyle.error),this;var c=this;this.core.perform(NativeMethod.login,function(d){c.setCurrentUser(d),b()})}return{login:{get:function get(){return a}}}}),native.extend(function(a){function b(g){if("function"==typeof g)return e.push(g),this;for(var h=0;h<e.length;h++)e[h].call(window);return this}function c(g,h,j,k){_NativeDefineProperties(this,{id:{get:function get(){return g}},name:{get:function get(){return h}},info:{get:function get(){return j}},version:{get:function get(){return k}}})}function d(g){f=new c(g.id,g.name,g.info,g.version),b()}var e=[],f=new c(a.currentUser.id,a.currentUser.name,a.currentUser.info,a.currentUser.version);return Native.cookie.value(NativeCookieKey.currentUser,JSON.stringify(f)),function(g){function h(){var k=JSON.parse(window.Native.cookie.value(NativeCookieKey.currentUser));(k.id!==g.currentUser.id||k.version!==g.currentUser.version)&&g.setCurrentUser(k)}function j(){window.addEventListener("pageshow",h),window.removeEventListener("pagehide",j)}window.addEventListener("pagehide",j)}(this),{setCurrentUser:{get:function get(){return d}},currentUserChange:{get:function get(){return b}},currentUser:{get:function get(){return f}}}}),native.extend(function(a){function b(f){function g(r,s){return"string"==typeof r?(n=r,s&&d.perform(NativeMethod.navigation.bar.setTitle,r),this):(Native.log("The navigation.bar.title must be a string value.",NativeLogStyle.error),this)}function h(r,s){return"string"==typeof r?(o=r,s&&d.perform(NativeMethod.navigation.bar.setTitleColor,r),this):(Native.log("The navigation.bar.titleColor must be a string value.",NativeLogStyle.error),this)}function j(r,s,t){return"boolean"==typeof r?(q=r,t&&d.perform(NativeMethod.navigation.bar.setHidden,r,s),this):(Native.log("The navigation.bar.isHidden must be a boolean value.",NativeLogStyle.error),this)}function k(r){return j(!0,r,!0),this}function l(r){return j(!1,r,!0),this}function m(r,s){return"string"==typeof r?(p=r,!s)?this:(d.perform(NativeMethod.navigation.bar.setBackgroundColor,r),this):(Native.log("The navigation.bar.backgroundColor must be a string value.",NativeLogStyle.error),this)}var n=f.title,o=f.titleColor,p=f.backgroundColor,q=f.isHidden;_NativeDefineProperties(this,{title:{get:function get(){return n},set:function set(r){g(r,!0)}},titleColor:{get:function get(){return o},set:function set(r){h(r,!0)}},backgroundColor:{get:function get(){return p},set:function set(r){m(r,!0)}},isHidden:{get:function get(){return q},set:function set(r){j(r,!1,!0)}},setTitle:{get:function get(){return g}},setTitleColor:{get:function get(){return h}},setBackgroundColor:{get:function get(){return m}},setHidden:{get:function get(){return j}},hide:{get:function get(){return k}},show:{get:function get(){return l}}})}var d=this.core,e=new function(f){var g=function(l,m){if("string"!=typeof l)return Native.log("Method `push` can not be called without a url parameter.",NativeLogStyle.error),null;if(!/^([a-z]+):\/\//i.test(l))if(/^(\/)/i.test(l))l=window.location.protocol+"//"+window.location.host+l;else{var n=window.location.href.split("/");n.pop(),l=n.join("/")+"/"+l}return"boolean"!=typeof m&&(m=!0),d.perform(NativeMethod.navigation.push,l,m)},h=function(l){return"boolean"!=typeof l&&(l=!0),d.perform(NativeMethod.navigation.pop,l)},j=function(l,m){return"number"==typeof l?("boolean"!=typeof m&&(m=!0),d.perform(NativeMethod.navigation.popTo,l,m)):void Native.log("Method `popTo` can not be called without a index parameter.",NativeLogStyle.error)},k=new b(f.bar);_NativeDefineProperties(this,{push:{get:function get(){return g}},pop:{get:function get(){return h}},popTo:{get:function get(){return j}},bar:{get:function get(){return k}}})}(a.navigation);return{navigation:{get:function get(){return e}}}});var NativeNetworkStatus=Object.freeze({WiFi:"WiFi"});native.extend(function(a){var c=this.core,d=new function(e){function f(l,m){return l&&"object"===("undefined"==typeof l?"undefined":_typeof(l))?c.perform(NativeMethod.networking.http,l,m):(Native.log("Method `http` first parameter must be an request object.",NativeLogStyle.error),null)}function g(l){if("function"==typeof l)return k.push(l),this;for(var m=0;m<k.length;m++)k[m].call(window)}function h(l){j=l,g()}var j=e.status,k=[];_NativeDefineProperties(this,{isViaWiFi:{get:function get(){return j===NativeNetworkStatus.WiFi}},status:{get:function get(){return j}},isReachable:{get:function get(){return!!j}},statusChange:{get:function get(){return g}},http:{get:function get(){return f}},setStatus:{get:function get(){return h}}})}(a.networking);return{networking:{get:function get(){return d}},http:{get:function get(){return d.http}}}}),native.extend(function(){function a(b){return"string"==typeof b?this.core.perform(NativeMethod.open,b):(Native.log("Method `open`'s page parameter must be a string value.",NativeLogStyle.error),null)}return{open:{get:function get(){return a}}}}),native.extend(function(){function a(c,d,e){if("string"!=typeof c)return Native.log("Method `present` first parameter must be a string value.",NativeLogStyle.error),null;var f=d,g=e;return"function"==typeof d&&(f=!0,g=d),"boolean"!=typeof f&&(f=!0),this.core.perform(NativeMethod.present,c,f,g)}function b(c,d){var e=c,f=d;return"function"==typeof c&&(e=!0,f=c),"boolean"!=typeof e&&(e=!0),this.core.perform(NativeMethod.dismiss,e,f)}return{present:{get:function get(){return a}},dismiss:{get:function get(){return b}}}}),native.extend(function(a){function b(f,g,h){d=f,window.Native.cookie.value(NativeCookieKey.currentTheme,f),h||"undefined"==typeof h?this.core.perform(NativeMethod.setCurrentTheme,f,g):c()}function c(f,g){if("function"==typeof f)return e.push({callback:f,animated:g}),this;for(var j,h=0;h<e.length;h++)j=e[h],j.callback.call(window,j.animated);return this}var d=a.currentTheme,e=[];return function(f){function g(){var j=window.Native.cookie.value(NativeCookieKey.currentTheme);j&&j!==f.currentTheme&&(f.setCurrentTheme(j,!1,!1),f.currentThemeChange())}function h(){window.removeEventListener("pagehide",h),window.addEventListener("pageshow",g)}window.addEventListener("pagehide",h)}(this),{currentTheme:{get:function get(){return d},set:function set(f){b(f,!1,!0)}},currentThemeChange:{get:function get(){return c}},setCurrentTheme:{get:function get(){return b}}}}),native.extend(function(){var b=this.core,c=new function(){function d(g,h,j,k){return"string"!=typeof g||"string"!=typeof h||"undefined"!=typeof j?(Native.log("Method `documentElementDidSelect` first/second/third parameter must be a string/string/number value.",NativeLogStyle.error),null):b.perform(NativeMethod.eventService.documentElementDidSelect,g,h,j,k)}function e(g,h,j,k){return"string"!=typeof g||"string"!=typeof h?(Native.log("Method `elementWasClicked` first/second parameter must be a string value.",NativeLogStyle.error),null):("function"==typeof j&&(k=j,j=null),b.perform(NativeMethod.eventService.documentElementWasClicked,g,h,j,k))}function f(g,h){return"string"==typeof g?b.perform(NativeMethod.eventService.track,g,h):(Native.log("Method `track` first parameter must be a string value.",NativeLogStyle.error),null)}_NativeDefineProperties(this,{documentElementDidSelect:{get:function get(){return d}},documentElementWasClicked:{get:function get(){return e}},track:{get:function get(){return f}}})};return{eventService:{get:function get(){return c}}}}),native.extend(function(){var b=this.core,c=new function(){function d(g,h,j){return"string"!=typeof g||"string"!=typeof h?(Native.log("Method `numberOfRowsInList` first/second parameter must be a string value.",NativeLogStyle.error),null):b.perform(NativeMethod.dataService.numberOfRowsInList,g,h,j)}function e(g,h,j,k){return"string"!=typeof g||"string"!=typeof h||"number"!=typeof j?(Native.log("Method `dataForRowAtIndex` first/second/third parameter must be a string/string/number value.",NativeLogStyle.error),null):b.perform(NativeMethod.dataService.dataForRowAtIndex,g,h,j,k)}function f(g,h,j){if("string"!=typeof g)return Native.log("Method `cachedResourceForURL` url parameter must be a string value.",NativeLogStyle.error),null;switch("undefined"==typeof h?"undefined":_typeof(h)){case"function":j=h,h=NativeCachedResourceType.image;break;case"string":break;default:h=NativeCachedResourceType.image;}return"function"==typeof j?b.perform(NativeMethod.dataService.cachedResourceForURL,g,h,j):(Native.log("Method `cachedResourceForURL` must have a callback handler.",NativeLogStyle.error),null)}_NativeDefineProperties(this,{numberOfRowsInList:{get:function get(){return d}},dataForRowAtIndex:{get:function get(){return e}},cachedResourceForURL:{get:function get(){return f}}})};return{dataService:{get:function get(){return c}}}}),native.extend(function(){function a(b,c){return b&&"object"===("undefined"==typeof b?"undefined":_typeof(b))?this.core.perform(NativeMethod.alert,b,c):(Native.log("Method `alert` first parameter must be an message object.",NativeLogStyle.error),null)}return{alert:{get:function get(){return a}}}});